Use Unity framework for unit tests: 
https://github.com/ThrowTheSwitch/Unity

Usefull ideas: 
https://mcuoneclipse.com/2023/12/18/modern-on-target-embedded-system-testing-with-cmake-and-ctest/

How to add variable in its own section: 
https://mcuoneclipse.com/2016/11/01/getting-the-memory-range-of-sections-with-gnu-linker-files/